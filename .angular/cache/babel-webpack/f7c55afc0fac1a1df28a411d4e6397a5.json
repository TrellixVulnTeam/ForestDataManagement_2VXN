{"ast":null,"code":"import { Workbook } from 'exceljs';\nimport * as fs from 'file-saver';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../nodeservice\";\nexport let UserComponent = /*#__PURE__*/(() => {\n  class UserComponent {\n    constructor(nodeService) {\n      this.nodeService = nodeService;\n      this.files1 = [];\n      this.flatFiles = [];\n      this.dataArray = [];\n      this.months = [{\n        name: 'January',\n        code: 'jan'\n      }, {\n        name: 'February',\n        code: 'feb'\n      }, {\n        name: 'March',\n        code: 'mar'\n      }, {\n        name: 'April',\n        code: 'apr'\n      }, {\n        name: 'May',\n        code: 'may'\n      }, {\n        name: 'June',\n        code: 'jun'\n      }, {\n        name: 'July',\n        code: 'jul'\n      }, {\n        name: 'August',\n        code: 'aug'\n      }, {\n        name: 'September',\n        code: 'sep'\n      }, {\n        name: 'October',\n        code: 'oct'\n      }, {\n        name: 'November',\n        code: 'nov'\n      }, {\n        name: 'December',\n        code: 'dec'\n      }];\n      this.circles = [{\n        name: 'Southern Circle - Kollam',\n        code: 'c1'\n      }, {\n        name: 'High Range Circle - Kottayam',\n        code: 'c2'\n      }, {\n        name: 'Central Circle - Thrissur',\n        code: 'c3'\n      }, {\n        name: 'Eastern Circle - Palakkad',\n        code: 'c4'\n      }, {\n        name: 'Northern Circle - Kannur',\n        code: 'c5'\n      }];\n      this.divisions = [// {name: 'Division 1', code: 'd1'},\n        // {name: 'Division 2', code: 'd2'},\n        // {name: 'Division 3', code: 'd3'},\n        // {name: 'Division 4', code: 'd4'}\n      ];\n      this.headofAccounts = [{\n        name: 'Forest Protection (Revenue)',\n        code: 'a1'\n      }, {\n        name: 'SOFB',\n        code: 'a2'\n      }, // {name: 'Extension Forestry', code: 'a3'},\n      {\n        name: 'Eco Tourism',\n        code: 'a4'\n      }, {\n        name: 'NABARD',\n        code: 'a5'\n      }, {\n        name: 'Parambikulam Tiger Rreserve',\n        code: 'a6'\n      }];\n      this.nodeService.getFilesystem().then(files => this.files1 = files);\n      this.nodeService.getFlatFilesystem().then(files => this.flatFiles = files);\n    }\n\n    ngOnInit() {}\n\n    setJson() {\n      this.dataArray = this.readKeys(this.flatFiles);\n    }\n\n    saveData() {\n      console.log(this.dataArray);\n    }\n\n    readKeys(data) {\n      let keyArr = [];\n      let k = 0;\n\n      for (let i in data) {\n        let idname = data[i].data['id'];\n        keyArr.push({\n          id: data[i].data['id'],\n          name: data[i].data['name'],\n          unit: data[i].data['unit']\n        });\n        keyArr[k][idname + 'pt'] = '';\n        keyArr[k][idname + 'pa'] = '';\n        keyArr[k][idname + 'ft'] = '';\n        keyArr[k][idname + 'fa'] = '';\n        k++;\n      }\n\n      return keyArr;\n    }\n\n    exportExcel() {\n      let workbook = new Workbook();\n      let worksheet = workbook.addWorksheet('Component Sheet');\n      worksheet.columns = [{\n        header: 'Id',\n        key: 'id',\n        width: 10\n      }, {\n        header: 'Name',\n        key: 'name',\n        width: 32\n      }, {\n        header: 'Physical Target',\n        key: 'pt',\n        width: 20\n      }, {\n        header: 'Physical achievement',\n        key: 'pa',\n        width: 20\n      }, {\n        header: 'Financial Target',\n        key: 'ft',\n        width: 20\n      }, {\n        header: 'Financial Achievement',\n        key: 'fa',\n        width: 20\n      }];\n      this.dataArray.forEach(e => {\n        worksheet.addRow({\n          id: e.id,\n          name: e.name,\n          pt: e[e.id + 'pt'],\n          pa: e[e.id + 'pa'],\n          ft: e[e.id + 'ft'],\n          fa: e[e.id + 'fa']\n        }, 'n');\n      });\n      workbook.xlsx.writeBuffer().then(data => {\n        let blob = new Blob([data], {\n          type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        });\n        fs.saveAs(blob, 'Division Data Sheet.xlsx');\n      });\n    }\n\n    setData(id, item, event) {\n      this.dataArray.forEach(element => {\n        if (element['id'] == id) {\n          element[id + '' + item] = event.target.value;\n        }\n      });\n    }\n\n  }\n\n  UserComponent.ɵfac = function UserComponent_Factory(t) {\n    return new (t || UserComponent)(i0.ɵɵdirectiveInject(i1.NodeService));\n  };\n\n  UserComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserComponent,\n    selectors: [[\"app-user\"]],\n    decls: 20,\n    vars: 0,\n    consts: [[1, \"d-flex\", \"justify-content-center\"], [1, \"text-center\"], [1, \"container-fluid\", \"px-4\"], [1, \"row\", \"gx-5\"], [1, \"col\"], [1, \"px-4\"], [1, \"container-fluid\", \"row\", \"p-4\"], [1, \"col\", \"text-center\", \"px-4\"], [\"type\", \"button\", 1, \"p-3\", \"btn\", \"btn-info\", 3, \"click\"]],\n    template: function UserComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"H4\");\n        i0.ɵɵtext(3, \"Monthly Progreess Report\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"H4\");\n        i0.ɵɵtext(5, \"Concurrent Evaluation and Monitoring Schemes 2021 - 22\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(6, \"hr\");\n        i0.ɵɵelementStart(7, \"div\", 2);\n        i0.ɵɵelementStart(8, \"H4\");\n        i0.ɵɵtext(9, \"Office:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 3);\n        i0.ɵɵelement(11, \"div\", 4);\n        i0.ɵɵelement(12, \"div\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"hr\");\n        i0.ɵɵelement(14, \"div\", 5);\n        i0.ɵɵelement(15, \"hr\");\n        i0.ɵɵelementStart(16, \"div\", 6);\n        i0.ɵɵelementStart(17, \"div\", 7);\n        i0.ɵɵelementStart(18, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function UserComponent_Template_button_click_18_listener() {\n          return ctx.exportExcel();\n        });\n        i0.ɵɵtext(19, \"Export as Excel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n    },\n    styles: [\"\"]\n  });\n  return UserComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}