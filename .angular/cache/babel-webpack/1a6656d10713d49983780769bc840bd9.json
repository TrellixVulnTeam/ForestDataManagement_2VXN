{"ast":null,"code":"import { Workbook } from 'exceljs';\nimport * as fs from 'file-saver';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../nodeservice\";\nimport * as i2 from \"primeng/dropdown\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"primeng/treetable\";\nimport * as i5 from \"primeng/api\";\n\nfunction UserComponent_ng_template_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"th\");\n    i0.ɵɵtext(2, \"Component\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"th\");\n    i0.ɵɵtext(4, \"Unit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Physical Target\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Physical Achievement\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Financial Target [in Lakhs]\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Financial Achievement [in Lakhs]\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserComponent_ng_template_28_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\", 16);\n    i0.ɵɵelementStart(1, \"td\", 17);\n    i0.ɵɵelement(2, \"p-treeTableToggler\", 18);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵelementStart(5, \"label\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵelementStart(8, \"input\", 19);\n    i0.ɵɵlistener(\"blur\", function UserComponent_ng_template_28_Template_input_blur_8_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const rowData_r3 = restoredCtx.rowData;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.setData(rowData_r3.id, \"pt\", $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵelementStart(10, \"input\", 20);\n    i0.ɵɵlistener(\"blur\", function UserComponent_ng_template_28_Template_input_blur_10_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const rowData_r3 = restoredCtx.rowData;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.setData(rowData_r3.id, \"pa\", $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵelementStart(12, \"input\", 21);\n    i0.ɵɵlistener(\"blur\", function UserComponent_ng_template_28_Template_input_blur_12_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const rowData_r3 = restoredCtx.rowData;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.setData(rowData_r3.id, \"ft\", $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵelementStart(14, \"input\", 22);\n    i0.ɵɵlistener(\"blur\", function UserComponent_ng_template_28_Template_input_blur_14_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const rowData_r3 = restoredCtx.rowData;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.setData(rowData_r3.id, \"fa\", $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const rowNode_r2 = ctx.$implicit;\n    const rowData_r3 = ctx.rowData;\n    i0.ɵɵproperty(\"ttRow\", rowNode_r2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"rowNode\", rowNode_r2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", rowData_r3.id, \". \", rowData_r3.name, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(rowData_r3.unit);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"\", rowData_r3.id, \"pt\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"\", rowData_r3.id, \"pa\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"\", rowData_r3.id, \"ft\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"\", rowData_r3.id, \"fa\");\n  }\n}\n\nexport let UserComponent = /*#__PURE__*/(() => {\n  class UserComponent {\n    constructor(nodeService) {\n      this.nodeService = nodeService;\n      this.files1 = [];\n      this.flatFiles = [];\n      this.dataArray = [];\n      this.months = [{\n        name: 'January',\n        code: 'jan'\n      }, {\n        name: 'February',\n        code: 'feb'\n      }, {\n        name: 'March',\n        code: 'mar'\n      }, {\n        name: 'April',\n        code: 'apr'\n      }, {\n        name: 'May',\n        code: 'may'\n      }, {\n        name: 'June',\n        code: 'jun'\n      }, {\n        name: 'July',\n        code: 'jul'\n      }, {\n        name: 'August',\n        code: 'aug'\n      }, {\n        name: 'September',\n        code: 'sep'\n      }, {\n        name: 'October',\n        code: 'oct'\n      }, {\n        name: 'November',\n        code: 'nov'\n      }, {\n        name: 'December',\n        code: 'dec'\n      }];\n      this.circles = [{\n        name: 'Southern Circle - Kollam',\n        code: 'c1'\n      }, {\n        name: 'High Range Circle - Kottayam',\n        code: 'c2'\n      }, {\n        name: 'Central Circle - Thrissur',\n        code: 'c3'\n      }, {\n        name: 'Eastern Circle - Palakkad',\n        code: 'c4'\n      }, {\n        name: 'Northern Circle - Kannur',\n        code: 'c5'\n      }];\n      this.divisions = [// {name: 'Division 1', code: 'd1'},\n        // {name: 'Division 2', code: 'd2'},\n        // {name: 'Division 3', code: 'd3'},\n        // {name: 'Division 4', code: 'd4'}\n      ];\n      this.headofAccounts = [{\n        name: 'Forest Protection (Revenue)',\n        code: 'a1'\n      }, {\n        name: 'SOFB',\n        code: 'a2'\n      }, // {name: 'Extension Forestry', code: 'a3'},\n      {\n        name: 'Eco Tourism',\n        code: 'a4'\n      }, {\n        name: 'NABARD',\n        code: 'a5'\n      }, {\n        name: 'Parambikulam Tiger Rreserve',\n        code: 'a6'\n      }];\n      this.nodeService.getFilesystem().then(files => this.files1 = files);\n      this.nodeService.getFlatFilesystem().then(files => this.flatFiles = files);\n    }\n\n    ngOnInit() {}\n\n    setJson() {\n      this.dataArray = this.readKeys(this.flatFiles);\n    }\n\n    saveData() {\n      console.log(this.dataArray);\n    }\n\n    readKeys(data) {\n      let keyArr = [];\n      let k = 0;\n\n      for (let i in data) {\n        let idname = data[i].data['id'];\n        keyArr.push({\n          id: data[i].data['id'],\n          name: data[i].data['name'],\n          unit: data[i].data['unit']\n        });\n        keyArr[k][idname + 'pt'] = '';\n        keyArr[k][idname + 'pa'] = '';\n        keyArr[k][idname + 'ft'] = '';\n        keyArr[k][idname + 'fa'] = '';\n        k++;\n      }\n\n      return keyArr;\n    }\n\n    exportExcel() {\n      let workbook = new Workbook();\n      let worksheet = workbook.addWorksheet('Component Sheet');\n      worksheet.columns = [{\n        header: 'Id',\n        key: 'id',\n        width: 10\n      }, {\n        header: 'Name',\n        key: 'name',\n        width: 32\n      }, {\n        header: 'Physical Target',\n        key: 'pt',\n        width: 20\n      }, {\n        header: 'Physical achievement',\n        key: 'pa',\n        width: 20\n      }, {\n        header: 'Financial Target',\n        key: 'ft',\n        width: 20\n      }, {\n        header: 'Financial Achievement',\n        key: 'fa',\n        width: 20\n      }];\n      this.dataArray.forEach(e => {\n        worksheet.addRow({\n          id: e.id,\n          name: e.name,\n          pt: e[e.id + 'pt'],\n          pa: e[e.id + 'pa'],\n          ft: e[e.id + 'ft'],\n          fa: e[e.id + 'fa']\n        }, 'n');\n      });\n      workbook.xlsx.writeBuffer().then(data => {\n        let blob = new Blob([data], {\n          type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        });\n        fs.saveAs(blob, 'Division Data Sheet.xlsx');\n      });\n    }\n\n    setData(id, item, event) {\n      this.dataArray.forEach(element => {\n        if (element['id'] == id) {\n          element[id + '' + item] = event.target.value;\n        }\n      });\n    }\n\n  }\n\n  UserComponent.ɵfac = function UserComponent_Factory(t) {\n    return new (t || UserComponent)(i0.ɵɵdirectiveInject(i1.NodeService));\n  };\n\n  UserComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserComponent,\n    selectors: [[\"app-user\"]],\n    decls: 33,\n    vars: 10,\n    consts: [[1, \"container-fluid\", \"d-flex\", \"justify-content-center\"], [1, \"text-center\"], [\"placeholder\", \"Select Month\", \"optionLabel\", \"name\", 3, \"options\", \"ngModel\", \"ngModelChange\"], [1, \"container-fluid\", \"px-4\"], [1, \"row\", \"gx-5\"], [1, \"col\"], [1, \"p-3\", \"border\", \"bg-light\"], [\"placeholder\", \"Select Circle\", \"optionLabel\", \"name\", 3, \"options\", \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"Select Division\", \"optionLabel\", \"name\", 3, \"options\", \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"Select Head of Account\", \"optionLabel\", \"name\", 3, \"options\", \"ngModel\", \"ngModelChange\", \"onChange\"], [\"id\", \"treeTable\", 3, \"value\", \"autoLayout\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [1, \"container-fluid\", \"row\", \"p-4\"], [1, \"col\", \"text-center\", \"px-4\"], [\"type\", \"button\", 1, \"p-3\", \"btn\", \"btn-info\", 3, \"click\"], [3, \"ttRow\"], [2, \"width\", \"max-content\"], [3, \"rowNode\"], [\"type\", \"text\", \"placeholder\", \"Physical Target\", 3, \"id\", \"blur\"], [\"type\", \"text\", \"placeholder\", \"Physical Achievement\", 3, \"id\", \"blur\"], [\"type\", \"text\", \"placeholder\", \"Financial Target [in Lakhs]\", 3, \"id\", \"blur\"], [\"type\", \"text\", \"placeholder\", \"Financial Achievement [in Lakhs]\", 3, \"id\", \"blur\"]],\n    template: function UserComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"H4\");\n        i0.ɵɵtext(3, \"Monthly Progreess Report\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"H4\");\n        i0.ɵɵtext(5, \"Concurrent Evaluation and Monitoring Schemes 2021 - 22 \");\n        i0.ɵɵelementStart(6, \"p-dropdown\", 2);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_p_dropdown_ngModelChange_6_listener($event) {\n          return ctx.selectedMonth = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(7, \"hr\");\n        i0.ɵɵelementStart(8, \"div\", 3);\n        i0.ɵɵelementStart(9, \"H4\");\n        i0.ɵɵtext(10, \"Office:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 4);\n        i0.ɵɵelementStart(12, \"div\", 5);\n        i0.ɵɵelementStart(13, \"div\", 6);\n        i0.ɵɵtext(14, \"Circle: \");\n        i0.ɵɵelementStart(15, \"p-dropdown\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_p_dropdown_ngModelChange_15_listener($event) {\n          return ctx.selectedCircle = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 5);\n        i0.ɵɵelementStart(17, \"div\", 6);\n        i0.ɵɵtext(18, \"Division: \");\n        i0.ɵɵelementStart(19, \"p-dropdown\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_p_dropdown_ngModelChange_19_listener($event) {\n          return ctx.selectedDivision = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"div\", 5);\n        i0.ɵɵelementStart(21, \"div\", 6);\n        i0.ɵɵtext(22, \"Head of Account: \");\n        i0.ɵɵelementStart(23, \"p-dropdown\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function UserComponent_Template_p_dropdown_ngModelChange_23_listener($event) {\n          return ctx.selectedHead = $event;\n        })(\"onChange\", function UserComponent_Template_p_dropdown_onChange_23_listener() {\n          return ctx.setJson();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(24, \"hr\");\n        i0.ɵɵelement(25, \"hr\");\n        i0.ɵɵelementStart(26, \"p-treeTable\", 10);\n        i0.ɵɵtemplate(27, UserComponent_ng_template_27_Template, 13, 0, \"ng-template\", 11);\n        i0.ɵɵtemplate(28, UserComponent_ng_template_28_Template, 15, 9, \"ng-template\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"div\", 13);\n        i0.ɵɵelementStart(30, \"div\", 14);\n        i0.ɵɵelementStart(31, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function UserComponent_Template_button_click_31_listener() {\n          return ctx.exportExcel();\n        });\n        i0.ɵɵtext(32, \"Export as Excel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"options\", ctx.months)(\"ngModel\", ctx.selectedMonth);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"options\", ctx.circles)(\"ngModel\", ctx.selectedCircle);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"options\", ctx.divisions)(\"ngModel\", ctx.selectedDivision);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"options\", ctx.headofAccounts)(\"ngModel\", ctx.selectedHead);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"value\", ctx.files1)(\"autoLayout\", true);\n      }\n    },\n    directives: [i2.Dropdown, i3.NgControlStatus, i3.NgModel, i4.TreeTable, i5.PrimeTemplate, i4.TTRow, i4.TreeTableToggler],\n    styles: [\"\"]\n  });\n  return UserComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}