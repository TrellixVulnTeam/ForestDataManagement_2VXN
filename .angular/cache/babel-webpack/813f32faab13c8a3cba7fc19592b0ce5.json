{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Workbook } from 'exceljs';\nimport * as fs from 'file-saver';\nlet UserComponent = class UserComponent {\n  constructor(nodeService) {\n    this.nodeService = nodeService;\n    this.files1 = [];\n    this.flatFiles = [];\n    this.dataArray = [];\n    this.months = [{\n      name: 'January',\n      code: 'jan'\n    }, {\n      name: 'February',\n      code: 'feb'\n    }, {\n      name: 'March',\n      code: 'mar'\n    }, {\n      name: 'April',\n      code: 'apr'\n    }, {\n      name: 'May',\n      code: 'may'\n    }, {\n      name: 'June',\n      code: 'jun'\n    }, {\n      name: 'July',\n      code: 'jul'\n    }, {\n      name: 'August',\n      code: 'aug'\n    }, {\n      name: 'September',\n      code: 'sep'\n    }, {\n      name: 'October',\n      code: 'oct'\n    }, {\n      name: 'November',\n      code: 'nov'\n    }, {\n      name: 'December',\n      code: 'dec'\n    }];\n    this.circles = [{\n      name: 'Southern Circle - Kollam',\n      code: 'c1'\n    }, {\n      name: 'High Range Circle - Kottayam',\n      code: 'c2'\n    }, {\n      name: 'Central Circle - Thrissur',\n      code: 'c3'\n    }, {\n      name: 'Eastern Circle - Palakkad',\n      code: 'c4'\n    }, {\n      name: 'Northern Circle - Kannur',\n      code: 'c5'\n    }];\n    this.divisions = [// {name: 'Division 1', code: 'd1'},\n      // {name: 'Division 2', code: 'd2'},\n      // {name: 'Division 3', code: 'd3'},\n      // {name: 'Division 4', code: 'd4'}\n    ];\n    this.headofAccounts = [{\n      name: 'Forest Protection (Revenue)',\n      code: 'a1'\n    }, {\n      name: 'SOFB',\n      code: 'a2'\n    }, // {name: 'Extension Forestry', code: 'a3'},\n    {\n      name: 'Eco Tourism',\n      code: 'a4'\n    }, {\n      name: 'NABARD',\n      code: 'a5'\n    }, {\n      name: 'Parambikulam Tiger Rreserve',\n      code: 'a6'\n    }]; // this.nodeService.getFilesystem().then((files) => (this.files1 = files));\n    // this.nodeService\n    //   .getFlatFilesystem()\n    //   .then((files) => (this.flatFiles = files));\n  }\n\n  ngOnInit() {}\n\n  setJson() {\n    this.dataArray = this.readKeys(this.flatFiles);\n  }\n\n  saveData() {\n    console.log(this.dataArray);\n  }\n\n  readKeys(data) {\n    let keyArr = [];\n    let k = 0;\n\n    for (let i in data) {\n      let idname = data[i].data['id'];\n      keyArr.push({\n        id: data[i].data['id'],\n        name: data[i].data['name'],\n        unit: data[i].data['unit']\n      });\n      keyArr[k][idname + 'pt'] = '';\n      keyArr[k][idname + 'pa'] = '';\n      keyArr[k][idname + 'ft'] = '';\n      keyArr[k][idname + 'fa'] = '';\n      k++;\n    }\n\n    return keyArr;\n  }\n\n  exportExcel() {\n    let workbook = new Workbook();\n    let worksheet = workbook.addWorksheet('Component Sheet');\n    worksheet.columns = [{\n      header: 'Id',\n      key: 'id',\n      width: 10\n    }, {\n      header: 'Name',\n      key: 'name',\n      width: 32\n    }, {\n      header: 'Physical Target',\n      key: 'pt',\n      width: 20\n    }, {\n      header: 'Physical achievement',\n      key: 'pa',\n      width: 20\n    }, {\n      header: 'Financial Target',\n      key: 'ft',\n      width: 20\n    }, {\n      header: 'Financial Achievement',\n      key: 'fa',\n      width: 20\n    }];\n    this.dataArray.forEach(e => {\n      worksheet.addRow({\n        id: e.id,\n        name: e.name,\n        pt: e[e.id + 'pt'],\n        pa: e[e.id + 'pa'],\n        ft: e[e.id + 'ft'],\n        fa: e[e.id + 'fa']\n      }, 'n');\n    });\n    workbook.xlsx.writeBuffer().then(data => {\n      let blob = new Blob([data], {\n        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n      });\n      fs.saveAs(blob, 'Division Data Sheet.xlsx');\n    });\n  }\n\n  setData(id, item, event) {\n    this.dataArray.forEach(element => {\n      if (element['id'] == id) {\n        element[id + '' + item] = event.target.value;\n      }\n    });\n  }\n\n};\nUserComponent = __decorate([Component({\n  selector: 'app-user',\n  templateUrl: './user.component.html',\n  styleUrls: ['./user.component.less']\n})], UserComponent);\nexport { UserComponent };","map":null,"metadata":{},"sourceType":"module"}